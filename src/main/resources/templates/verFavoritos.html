<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Ver Restaurantes</title>
    <style>
        /* Agregar estilos */
    </style>
</head>
<body>
    <div class="container" th:with="vistaFavoritos=${vistaFavoritos != null ? vistaFavoritos : false}">
        <!-- Verificar si el usuario está autenticado -->
        <div th:if="${usuario != null}">
            <div th:if="${usuario.idUsuario} != 'anónimo'">
                <p>Hola <span th:text="${usuario.idUsuario}"></span></p>
                <a th:href="@{/clientes/editarDatos}">Editar datos</a>
                <a th:href="@{/clientes/logout}">Cerrar sesión</a>
            </div>
        </div>

        <!-- Título -->
        <h2>Buscar y Ver Restaurantes</h2>

        <!-- Botones para alternar entre ver todos los restaurantes y solo favoritos -->
        <a th:href="@{/clientes/verRestaurantes}" th:if="${vistaFavoritos}" class="toggle-favorites">Ver Todos</a>
        <a th:href="@{/clientes/favoritos}" th:if="${!vistaFavoritos}" class="toggle-favorites">Ver Favoritos</a>

        <!-- Formulario para filtrar restaurantes por nombre -->
        <form th:action="@{/clientes/filtrar}" method="get">
            <input type="text" id="nombre" name="nombre" placeholder="Filtrar restaurante por nombre">
            <button type="submit">Filtrar</button>
        </form>

        <!-- Grid de restaurantes -->
        <div class="restaurant-grid">
            <div th:each="restaurante : ${restaurantes}" class="restaurant-card">
                <div class="restaurant-name" th:text="${restaurante.nombre}"></div>
                <a th:href="@{/clientes/verMenusRestaurante/{id}(id=${restaurante.idUsuario})}">Ver Menús</a>

                <!-- Estrella de favorito, muestra según estado de favorito -->
                <form th:action="@{/clientes/marcarFavorito/{idRestaurante}(idRestaurante=${restaurante.idUsuario})}"
                      th:if="${usuario != null && usuario.idUsuario != 'anónimo'}" method="post" class="favorite-form">
                    <button type="submit" class="favorite-star"
                            th:classappend="${#lists.contains(usuario.favoritos, restaurante) ? 'favorited' : ''}"
                            title="Marcar como Favorito">
                        <span class="favorite-icon"
                              th:text="${#lists.contains(usuario.favoritos, restaurante) ? '★' : '☆'}"></span>
                    </button>
                </form>
            </div>
        </div>
    </div>
</body>
</html>
